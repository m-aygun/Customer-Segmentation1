<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.54">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Mette Jonassen-Aygün">
<meta name="dcterms.date" content="2025-03-13">
<meta name="description" content="beskrivelse">

<title>Customer segmentation through unsupervised learning K-means</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Customer segmentation through unsupervised learning K-means</h1>
                  <div>
        <div class="description">
          beskrivelse
        </div>
      </div>
                </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author">Mette Jonassen-Aygün </p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Erhvervsakademi Dania
            </p>
        </div>
    </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Updated</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 13, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="4">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introductio" id="toc-introductio" class="nav-link active" data-scroll-target="#introductio"><span class="header-section-number">1</span> Introductio</a>
  <ul class="collapse">
  <li><a href="#key-highlights-of-my-work" id="toc-key-highlights-of-my-work" class="nav-link" data-scroll-target="#key-highlights-of-my-work"><span class="header-section-number">1.0.1</span> <strong>Key Highlights of My Work:</strong></a></li>
  </ul></li>
  <li><a href="#crisp-dm" id="toc-crisp-dm" class="nav-link" data-scroll-target="#crisp-dm"><span class="header-section-number">2</span> Crisp-DM</a>
  <ul class="collapse">
  <li><a href="#business-understanding" id="toc-business-understanding" class="nav-link" data-scroll-target="#business-understanding"><span class="header-section-number">2.1</span> Business Understanding</a></li>
  <li><a href="#the-value-of-customer-segmentation" id="toc-the-value-of-customer-segmentation" class="nav-link" data-scroll-target="#the-value-of-customer-segmentation"><span class="header-section-number">2.2</span> <strong>The Value of Customer Segmentation</strong></a>
  <ul class="collapse">
  <li><a href="#why-segment-customers-based-on-data" id="toc-why-segment-customers-based-on-data" class="nav-link" data-scroll-target="#why-segment-customers-based-on-data"><span class="header-section-number">2.2.1</span> <strong>Why Segment Customers Based on Data?</strong></a></li>
  </ul></li>
  <li><a href="#the-role-of-machine-learning-in-segmentation" id="toc-the-role-of-machine-learning-in-segmentation" class="nav-link" data-scroll-target="#the-role-of-machine-learning-in-segmentation"><span class="header-section-number">2.3</span> <strong>The Role of Machine Learning in Segmentation</strong></a></li>
  <li><a href="#data-understanding" id="toc-data-understanding" class="nav-link" data-scroll-target="#data-understanding"><span class="header-section-number">2.4</span> Data Understanding</a>
  <ul class="collapse">
  <li><a href="#installing-and-loading-packages" id="toc-installing-and-loading-packages" class="nav-link" data-scroll-target="#installing-and-loading-packages"><span class="header-section-number">2.4.1</span> Installing and Loading packages</a></li>
  <li><a href="#load-and-inspect-data-set" id="toc-load-and-inspect-data-set" class="nav-link" data-scroll-target="#load-and-inspect-data-set"><span class="header-section-number">2.4.2</span> Load and inspect data set</a></li>
  <li><a href="#eda" id="toc-eda" class="nav-link" data-scroll-target="#eda"><span class="header-section-number">2.4.3</span> EDA</a></li>
  </ul></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation"><span class="header-section-number">2.5</span> Data Preparation</a>
  <ul class="collapse">
  <li><a href="#adding-variables" id="toc-adding-variables" class="nav-link" data-scroll-target="#adding-variables"><span class="header-section-number">2.5.1</span> Adding variables</a></li>
  <li><a href="#adding-dummy-variables" id="toc-adding-dummy-variables" class="nav-link" data-scroll-target="#adding-dummy-variables"><span class="header-section-number">2.5.2</span> Adding dummy variables</a></li>
  </ul></li>
  <li><a href="#modelling" id="toc-modelling" class="nav-link" data-scroll-target="#modelling"><span class="header-section-number">2.6</span> Modelling</a></li>
  <li><a href="#evaluation" id="toc-evaluation" class="nav-link" data-scroll-target="#evaluation"><span class="header-section-number">2.7</span> Evaluation</a></li>
  <li><a href="#deployment" id="toc-deployment" class="nav-link" data-scroll-target="#deployment"><span class="header-section-number">2.8</span> Deployment</a>
  <ul class="collapse">
  <li><a href="#segment-insights-actionable-strategies" id="toc-segment-insights-actionable-strategies" class="nav-link" data-scroll-target="#segment-insights-actionable-strategies"><span class="header-section-number">2.8.1</span> <strong>Segment Insights &amp; Actionable Strategies</strong></a></li>
  <li><a href="#how-to-use-these-insights" id="toc-how-to-use-these-insights" class="nav-link" data-scroll-target="#how-to-use-these-insights"><span class="header-section-number">2.8.2</span> <strong>How to Use These Insights</strong></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#recommendations" id="toc-recommendations" class="nav-link" data-scroll-target="#recommendations"><span class="header-section-number">3</span> Recommendations</a>
  <ul class="collapse">
  <li><a href="#potential-improvements-to-the-model" id="toc-potential-improvements-to-the-model" class="nav-link" data-scroll-target="#potential-improvements-to-the-model"><span class="header-section-number">3.0.1</span> <strong>Potential Improvements to the Model</strong></a></li>
  <li><a href="#applying-apriori-can-add-value-to-customer-segmentation" id="toc-applying-apriori-can-add-value-to-customer-segmentation" class="nav-link" data-scroll-target="#applying-apriori-can-add-value-to-customer-segmentation"><span class="header-section-number">3.0.2</span> <strong>Applying Apriori Can Add Value to Customer Segmentation</strong></a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">4</span> <strong>Conclusion</strong></a>
  <ul class="collapse">
  <li><a href="#business-implications" id="toc-business-implications" class="nav-link" data-scroll-target="#business-implications"><span class="header-section-number">4.0.1</span> <strong>Business Implications</strong></a></li>
  <li><a href="#future-improvements" id="toc-future-improvements" class="nav-link" data-scroll-target="#future-improvements"><span class="header-section-number">4.0.2</span> <strong>Future Improvements</strong></a></li>
  </ul></li>
  <li><a href="#litterature" id="toc-litterature" class="nav-link" data-scroll-target="#litterature"><span class="header-section-number">5</span> Litterature</a></li>
  </ul>
</nav>
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="introductio" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introductio</h1>
<p>Welcome to my portfolio, where I showcase my expertise in <strong>data analysis, machine learning, and customer segmentation</strong>.</p>
<p>This project focuses on <strong>customer behavior analysis using the Online Retail dataset</strong>, following the <strong>CRISP-DM framework</strong> to transform raw transaction data into <strong>actionable business insights</strong>.</p>
<p>Through <strong>data wrangling, exploratory data analysis (EDA), feature engineering, and K-means clustering</strong>, I segment customers into <strong>distinct behavioral groups</strong>. This enables businesses to optimize <strong>marketing strategies, improve customer retention, and maximize revenue</strong>.</p>
<section id="key-highlights-of-my-work" class="level3" data-number="1.0.1">
<h3 data-number="1.0.1" class="anchored" data-anchor-id="key-highlights-of-my-work"><span class="header-section-number">1.0.1</span> <strong>Key Highlights of My Work:</strong></h3>
<ul>
<li><p><strong>Data Cleaning &amp; Preprocessing</strong>: Handling missing values, feature engineering, and standardizing data.</p></li>
<li><p><strong>Customer Segmentation</strong>: Applying <strong>K-means clustering</strong> to identify key customer segments.</p></li>
<li><p><strong>Business Strategy Recommendations</strong>: Developing <strong>actionable insights</strong> based on clustering results.</p></li>
<li><p><strong>Visualization &amp; Interpretation</strong>: Using <strong>ggplot2 and radar charts</strong> to present findings in an intuitive way.</p></li>
</ul>
<p>The findings from this project provide <strong>real-world applications</strong> in e-commerce and retail, helping businesses create targeted <strong>marketing strategies, loyalty programs, and personalized promotions</strong>.</p>
<p>Feel free to explore my work and connect if you’re interested in <strong>data-driven solutions for business growth!</strong> 🚀</p>
</section>
</section>
<section id="crisp-dm" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Crisp-DM</h1>
<p>CRISP-DM (<strong>Cross-Industry Standard Process for Data Mining</strong>) is a widely used framework for structuring data science projects. It consists of <strong>six iterative phases</strong> that ensure a systematic and business-driven approach to data analysis:</p>
<ol type="1">
<li><p><strong>Business Understanding</strong> – Define objectives, key questions, and success criteria.</p></li>
<li><p><strong>Data Understanding</strong> – Explore, visualize, and assess data quality.</p></li>
<li><p><strong>Data Preparation</strong> – Clean, transform, and preprocess data for modeling.</p></li>
<li><p><strong>Modeling</strong> – Apply machine learning or statistical techniques to extract insights.</p></li>
<li><p><strong>Evaluation</strong> – Validate model performance and ensure alignment with business goals.</p></li>
<li><p><strong>Deployment</strong> – Implement the model into production and monitor its impact.</p></li>
</ol>
<p>By following CRISP-DM, data scientists can <strong>streamline workflows, reduce errors, and enhance project success rates</strong> while maintaining a strong focus on business objectives. 🚀</p>
<section id="business-understanding" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="business-understanding"><span class="header-section-number">2.1</span> Business Understanding</h2>
</section>
<section id="the-value-of-customer-segmentation" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="the-value-of-customer-segmentation"><span class="header-section-number">2.2</span> <strong>The Value of Customer Segmentation</strong></h2>
<p>In today’s competitive market, <strong>understanding customer behavior</strong> is crucial for businesses aiming to improve engagement, increase sales, and optimize marketing efforts. Customer segmentation is a powerful <strong>data-driven strategy</strong> that allows businesses to group customers based on their purchasing patterns, preferences, and behaviors. By leveraging <strong>machine learning techniques</strong> such as K-Means clustering, businesses can move beyond generic marketing and develop <strong>targeted strategies</strong> that resonate with different customer groups.</p>
<section id="why-segment-customers-based-on-data" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="why-segment-customers-based-on-data"><span class="header-section-number">2.2.1</span> <strong>Why Segment Customers Based on Data?</strong></h3>
<p>1️⃣ <strong>Personalized Marketing &amp; Customer Engagement</strong></p>
<ul>
<li>Generic marketing campaigns often fail to resonate with all customers. By segmenting customers based on their behavior, businesses can <strong>tailor offers, promotions, and recommendations</strong> to specific groups, increasing engagement and conversions.</li>
</ul>
<p>2️⃣ <strong>Optimized Pricing &amp; Product Offerings</strong></p>
<ul>
<li>Different customer segments have varying purchasing power and buying habits. Segmentation helps businesses <strong>identify high-value customers, bulk buyers, and occasional shoppers</strong>, allowing for <strong>dynamic pricing strategies</strong> and better product positioning.</li>
</ul>
<p>3️⃣ <strong>Improved Customer Retention &amp; Loyalty Programs</strong></p>
<ul>
<li>Understanding which customers are at risk of <strong>churning</strong> enables businesses to implement <strong>proactive retention strategies</strong>. For example, customers with declining purchase frequency can be re-engaged through <strong>personalized offers and loyalty programs</strong>.</li>
</ul>
<p>4️⃣ <strong>Efficient Resource Allocation</strong></p>
<ul>
<li>Businesses have <strong>limited marketing budgets</strong> and resources. A data-driven segmentation approach helps optimize marketing spend by ensuring that <strong>resources are allocated to the most profitable customer groups</strong> while minimizing efforts on less engaged segments.</li>
</ul>
<p>5️⃣ <strong>Enhanced Business Decision-Making</strong></p>
<ul>
<li>Customer segmentation provides <strong>actionable insights</strong> that drive strategic decisions, from <strong>inventory management</strong> to <strong>new product launches</strong>. Understanding what different customer groups value allows businesses to make informed, <strong>data-backed decisions</strong> rather than relying on assumptions.</li>
</ul>
</section>
</section>
<section id="the-role-of-machine-learning-in-segmentation" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="the-role-of-machine-learning-in-segmentation"><span class="header-section-number">2.3</span> <strong>The Role of Machine Learning in Segmentation</strong></h2>
<p>Traditional segmentation methods, such as demographic-based grouping, often <strong>oversimplify customer behavior</strong>. With machine learning techniques like <strong>K-Means clustering</strong>, businesses can analyze vast amounts of transaction data to uncover <strong>hidden patterns</strong> and create <strong>more precise segments</strong> based on actual purchasing behavior.</p>
<p>This segmentation approach enables businesses to:<br>
✔ Identify <strong>distinct customer profiles</strong> based on <strong>purchase frequency, total spend, product preferences, and activity levels</strong>.<br>
✔ Detect <strong>at-risk customers</strong> and implement strategies to <strong>prevent churn</strong>.<br>
✔ Recognize and nurture <strong>high-value customers</strong> to maximize profitability.</p>
<p>By applying <strong>data-driven customer segmentation</strong>, businesses can create <strong>highly effective, targeted marketing campaigns</strong>, enhance <strong>customer experience</strong>, and <strong>increase overall revenue growth</strong>.</p>
</section>
<section id="data-understanding" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="data-understanding"><span class="header-section-number">2.4</span> Data Understanding</h2>
<p>The <strong>Data Understanding</strong> phase in CRISP-DM focuses on exploring and assessing the dataset to ensure its quality and relevance for analysis. This includes <strong>data collection, exploratory data analysis (EDA), data visualization, and identifying missing values or inconsistencies</strong>. By gaining insights into the structure, distributions, and potential biases in the data, this step helps guide effective <strong>data preparation and modeling</strong>.</p>
<section id="installing-and-loading-packages" class="level3" data-number="2.4.1">
<h3 data-number="2.4.1" class="anchored" data-anchor-id="installing-and-loading-packages"><span class="header-section-number">2.4.1</span> Installing and Loading packages</h3>
<p>First we will install and load the packagges need for the project.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># List of required packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>packages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tidyverse"</span>, <span class="st">"magrittr"</span>, <span class="st">"nycflights13"</span>, <span class="st">"gapminder"</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Lahman"</span>, <span class="st">"maps"</span>, <span class="st">"lubridate"</span>, <span class="st">"pryr"</span>, <span class="st">"hms"</span>, <span class="st">"hexbin"</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>              <span class="st">"feather"</span>, <span class="st">"htmlwidgets"</span>, <span class="st">"broom"</span>, <span class="st">"pander"</span>, <span class="st">"modelr"</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>              <span class="st">"XML"</span>, <span class="st">"httr"</span>, <span class="st">"jsonlite"</span>, <span class="st">"microbenchmark"</span>, <span class="st">"splines"</span>, </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>              <span class="st">"ISLR2"</span>, <span class="st">"MASS"</span>, <span class="st">"testthat"</span>, <span class="st">"caret"</span>, <span class="st">"RSQLite"</span>, <span class="st">"class"</span>, </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>              <span class="st">"babynames"</span>, <span class="st">"nasaweather"</span>, <span class="st">"pls"</span>, <span class="st">"fueleconomy"</span>, <span class="st">"viridis"</span>, </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>              <span class="st">"boot"</span>, <span class="st">"devtools"</span>, <span class="st">"tree"</span>, <span class="st">"leaps"</span>, <span class="st">"glmnet"</span>, <span class="st">"gam"</span>, <span class="st">"akima"</span>, </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>              <span class="st">"factoextra"</span>, <span class="st">"randomForest"</span>, <span class="st">"gbm"</span>, <span class="st">"ggrepel"</span>, <span class="st">"GGally"</span>, </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>              <span class="st">"fmsb"</span>, <span class="st">"sjPlot"</span>, <span class="st">"rcompanion"</span>, <span class="st">"DT"</span>, <span class="st">"ggplot2"</span>, <span class="st">"pROC"</span>, <span class="st">"readxl"</span>, <span class="st">"reshape2"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to check and install missing packages</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>install_if_missing <span class="ot">&lt;-</span> <span class="cf">function</span>(pkg) {</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(pkg, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(pkg, <span class="at">dependencies =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Install missing packages</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(packages, install_if_missing)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Load all packages</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(packages, library, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="load-and-inspect-data-set" class="level3" data-number="2.4.2">
<h3 data-number="2.4.2" class="anchored" data-anchor-id="load-and-inspect-data-set"><span class="header-section-number">2.4.2</span> Load and inspect data set</h3>
<p>The dataset is loaded and inspected. The data set can be downloaded here: https://www.kaggle.com/datasets/vijayuv/onlineretail</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>retaildata <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"Online Retail.xlsx"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(retaildata) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
  InvoiceNo StockCode Description         Quantity InvoiceDate         UnitPrice
  &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;                  &lt;dbl&gt; &lt;dttm&gt;                  &lt;dbl&gt;
1 536365    85123A    WHITE HANGING HEAR…        6 2010-12-01 08:26:00      2.55
2 536365    71053     WHITE METAL LANTERN        6 2010-12-01 08:26:00      3.39
3 536365    84406B    CREAM CUPID HEARTS…        8 2010-12-01 08:26:00      2.75
4 536365    84029G    KNITTED UNION FLAG…        6 2010-12-01 08:26:00      3.39
5 536365    84029E    RED WOOLLY HOTTIE …        6 2010-12-01 08:26:00      3.39
6 536365    22752     SET 7 BABUSHKA NES…        2 2010-12-01 08:26:00      7.65
# ℹ 2 more variables: CustomerID &lt;dbl&gt;, Country &lt;chr&gt;</code></pre>
</div>
</div>
</section>
<section id="eda" class="level3" data-number="2.4.3">
<h3 data-number="2.4.3" class="anchored" data-anchor-id="eda"><span class="header-section-number">2.4.3</span> EDA</h3>
<p>Exploratory analysis is the process of examining and visualizing a dataset to uncover patterns, spot anomalies, and test hypotheses. It involves generating summary statistics, creating visualizations like histograms, box plots, and scatter plots, and identifying relationships between variables. This initial step helps in understanding the structure and distribution of the data, revealing trends and outliers, and informing subsequent data preparation and modeling efforts.</p>
<p>We aim to assess the extent of missing values and examine the dataset’s dimensions and data types.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(retaildata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  InvoiceNo          StockCode         Description           Quantity        
 Length:541909      Length:541909      Length:541909      Min.   :-80995.00  
 Class :character   Class :character   Class :character   1st Qu.:     1.00  
 Mode  :character   Mode  :character   Mode  :character   Median :     3.00  
                                                          Mean   :     9.55  
                                                          3rd Qu.:    10.00  
                                                          Max.   : 80995.00  
                                                                             
  InvoiceDate                       UnitPrice           CustomerID    
 Min.   :2010-12-01 08:26:00.00   Min.   :-11062.06   Min.   :12346   
 1st Qu.:2011-03-28 11:34:00.00   1st Qu.:     1.25   1st Qu.:13953   
 Median :2011-07-19 17:17:00.00   Median :     2.08   Median :15152   
 Mean   :2011-07-04 13:34:57.16   Mean   :     4.61   Mean   :15288   
 3rd Qu.:2011-10-19 11:27:00.00   3rd Qu.:     4.13   3rd Qu.:16791   
 Max.   :2011-12-09 12:50:00.00   Max.   : 38970.00   Max.   :18287   
                                                      NA's   :135080  
   Country         
 Length:541909     
 Class :character  
 Mode  :character  
                   
                   
                   
                   </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(retaildata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [541,909 × 8] (S3: tbl_df/tbl/data.frame)
 $ InvoiceNo  : chr [1:541909] "536365" "536365" "536365" "536365" ...
 $ StockCode  : chr [1:541909] "85123A" "71053" "84406B" "84029G" ...
 $ Description: chr [1:541909] "WHITE HANGING HEART T-LIGHT HOLDER" "WHITE METAL LANTERN" "CREAM CUPID HEARTS COAT HANGER" "KNITTED UNION FLAG HOT WATER BOTTLE" ...
 $ Quantity   : num [1:541909] 6 6 8 6 6 2 6 6 6 32 ...
 $ InvoiceDate: POSIXct[1:541909], format: "2010-12-01 08:26:00" "2010-12-01 08:26:00" ...
 $ UnitPrice  : num [1:541909] 2.55 3.39 2.75 3.39 3.39 7.65 4.25 1.85 1.85 1.69 ...
 $ CustomerID : num [1:541909] 17850 17850 17850 17850 17850 ...
 $ Country    : chr [1:541909] "United Kingdom" "United Kingdom" "United Kingdom" "United Kingdom" ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(retaildata))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 136534</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(retaildata))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  InvoiceNo   StockCode Description    Quantity InvoiceDate   UnitPrice 
          0           0        1454           0           0           0 
 CustomerID     Country 
     135080           0 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>na_rows <span class="ot">&lt;-</span> retaildata[<span class="sc">!</span><span class="fu">complete.cases</span>(retaildata), ]</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>na_rows</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 135,080 × 8
   InvoiceNo StockCode Description        Quantity InvoiceDate         UnitPrice
   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;                 &lt;dbl&gt; &lt;dttm&gt;                  &lt;dbl&gt;
 1 536414    22139     &lt;NA&gt;                     56 2010-12-01 11:52:00      0   
 2 536544    21773     DECORATIVE ROSE B…        1 2010-12-01 14:32:00      2.51
 3 536544    21774     DECORATIVE CATS B…        2 2010-12-01 14:32:00      2.51
 4 536544    21786     POLKADOT RAIN HAT         4 2010-12-01 14:32:00      0.85
 5 536544    21787     RAIN PONCHO RETRO…        2 2010-12-01 14:32:00      1.66
 6 536544    21790     VINTAGE SNAP CARDS        9 2010-12-01 14:32:00      1.66
 7 536544    21791     VINTAGE HEADS AND…        2 2010-12-01 14:32:00      2.51
 8 536544    21801     CHRISTMAS TREE DE…       10 2010-12-01 14:32:00      0.43
 9 536544    21802     CHRISTMAS TREE HE…        9 2010-12-01 14:32:00      0.43
10 536544    21803     CHRISTMAS TREE ST…       11 2010-12-01 14:32:00      0.43
# ℹ 135,070 more rows
# ℹ 2 more variables: CustomerID &lt;dbl&gt;, Country &lt;chr&gt;</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(retaildata, UnitPrice <span class="sc">==</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,515 × 8
   InvoiceNo StockCode Description Quantity InvoiceDate         UnitPrice
   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;          &lt;dbl&gt; &lt;dttm&gt;                  &lt;dbl&gt;
 1 536414    22139     &lt;NA&gt;              56 2010-12-01 11:52:00         0
 2 536545    21134     &lt;NA&gt;               1 2010-12-01 14:32:00         0
 3 536546    22145     &lt;NA&gt;               1 2010-12-01 14:33:00         0
 4 536547    37509     &lt;NA&gt;               1 2010-12-01 14:33:00         0
 5 536549    85226A    &lt;NA&gt;               1 2010-12-01 14:34:00         0
 6 536550    85044     &lt;NA&gt;               1 2010-12-01 14:34:00         0
 7 536552    20950     &lt;NA&gt;               1 2010-12-01 14:34:00         0
 8 536553    37461     &lt;NA&gt;               3 2010-12-01 14:35:00         0
 9 536554    84670     &lt;NA&gt;              23 2010-12-01 14:35:00         0
10 536589    21777     &lt;NA&gt;             -10 2010-12-01 16:50:00         0
# ℹ 2,505 more rows
# ℹ 2 more variables: CustomerID &lt;dbl&gt;, Country &lt;chr&gt;</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(retaildata<span class="sc">$</span>Country))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 38</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>retaildata <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="fu">list</span>(<span class="at">min =</span> <span class="sc">~</span><span class="fu">min</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">max =</span> <span class="sc">~</span><span class="fu">max</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  Quantity_min Quantity_max UnitPrice_min UnitPrice_max CustomerID_min
         &lt;dbl&gt;        &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;          &lt;dbl&gt;
1       -80995        80995       -11062.         38970          12346
# ℹ 1 more variable: CustomerID_max &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
</section>
<section id="data-preparation" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="data-preparation"><span class="header-section-number">2.5</span> Data Preparation</h2>
<p>The <strong>Data Preparation</strong> phase in CRISP-DM involves transforming raw data into a clean and structured format suitable for modeling. This includes <strong>handling missing values, removing duplicates, feature engineering, encoding categorical variables, scaling numerical data, and selecting relevant features</strong>. A well-prepared dataset enhances model accuracy and ensures meaningful insights, making this step <strong>crucial for the success of any data-driven project</strong>. 🚀</p>
<p>Removing NA values and transforming values in the column Country into factors</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>retaildata <span class="ot">&lt;-</span> <span class="fu">subset</span>(retaildata, <span class="sc">!</span><span class="fu">is.na</span>(CustomerID))</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>retaildata<span class="sc">$</span>Country <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(retaildata<span class="sc">$</span>Country)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="adding-variables" class="level3" data-number="2.5.1">
<h3 data-number="2.5.1" class="anchored" data-anchor-id="adding-variables"><span class="header-section-number">2.5.1</span> Adding variables</h3>
<p>Based on the availalbe variables additional features are added.</p>
<p>The code enhances the dataset by creating several new customer-level features. For each customer (grouped by CustomerID), it computes:</p>
<p>Total Distinct Stock Codes: the number of unique products purchased. Total Quantity Purchased: the sum of all item quantities bought. Customer Active Days: the time span in days from the customer’s first order to their last order. Average Days Between Orders: the mean number of days separating consecutive orders, with missing values replaced by zero. Total Orders: the count of unique invoices. Total Quantity: a re-calculation of the overall number of items purchased. Total Spent: the total monetary amount spent, computed as the sum of Quantity multiplied by UnitPrice. Average Spent Per Product: derived by dividing total spent by the number of distinct products. Average Quantity Per Order: calculated as the total quantity purchased divided by the number of orders.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>retaildata <span class="ot">&lt;-</span> retaildata <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(CustomerID) <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_distinct_stockcodes =</span> <span class="fu">n_distinct</span>(StockCode)) <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>retaildata <span class="ot">&lt;-</span> retaildata <span class="sc">%&gt;%</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(CustomerID) <span class="sc">%&gt;%</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_quantity_purchased =</span> <span class="fu">sum</span>(Quantity, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co">#avg days betwwen orders</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>retaildata <span class="ot">&lt;-</span> retaildata <span class="sc">%&gt;%</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(CustomerID) <span class="sc">%&gt;%</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">first_order_date =</span> <span class="fu">min</span>(InvoiceDate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">last_order_date =</span> <span class="fu">max</span>(InvoiceDate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">customer_active_days =</span> <span class="fu">as.numeric</span>(<span class="fu">difftime</span>(last_order_date, first_order_date, <span class="at">units =</span> <span class="st">"days"</span>))</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>retaildata <span class="ot">&lt;-</span> retaildata <span class="sc">%&gt;%</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(CustomerID) <span class="sc">%&gt;%</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(InvoiceDate) <span class="sc">%&gt;%</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">days_since_last_order =</span> <span class="fu">as.numeric</span>(<span class="fu">difftime</span>(InvoiceDate, <span class="fu">lag</span>(InvoiceDate), <span class="at">units =</span> <span class="st">"days"</span>)),</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_days_between_orders =</span> <span class="fu">mean</span>(days_since_last_order, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">days_since_last_order =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(days_since_last_order), <span class="dv">0</span>, days_since_last_order)  <span class="co"># Replace NA with 0</span></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a><span class="co"># No of orders</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>retaildata <span class="ot">&lt;-</span> retaildata <span class="sc">%&gt;%</span></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(CustomerID) <span class="sc">%&gt;%</span>  <span class="co"># Group data by CustomerID</span></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_orders =</span> <span class="fu">n_distinct</span>(InvoiceNo)  <span class="co"># Count unique InvoiceNo per customer</span></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()  <span class="co"># Remove grouping to maintain normal dataframe structure</span></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>retaildata <span class="ot">&lt;-</span> retaildata <span class="sc">%&gt;%</span></span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(CustomerID) <span class="sc">%&gt;%</span>  <span class="co"># Group data by CustomerID</span></span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_quantity =</span> <span class="fu">sum</span>(Quantity, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)  <span class="co"># Sum all Quantity values per customer</span></span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()  <span class="co"># Remove grouping to restore normal dataframe structure</span></span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>retaildata <span class="ot">&lt;-</span> retaildata <span class="sc">%&gt;%</span></span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(CustomerID) <span class="sc">%&gt;%</span>  <span class="co"># Group by Customer</span></span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_unique_stockcodes =</span> <span class="fu">n_distinct</span>(StockCode)  <span class="co"># Count unique StockCodes per customer</span></span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a>retaildata <span class="ot">&lt;-</span> retaildata <span class="sc">%&gt;%</span></span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(CustomerID) <span class="sc">%&gt;%</span>  <span class="co"># Group by CustomerID</span></span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_spent =</span> <span class="fu">sum</span>(Quantity <span class="sc">*</span> UnitPrice, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)  <span class="co"># Sum total amount spent per customer</span></span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()  <span class="co"># Remove grouping to restore normal dataframe structure</span></span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a>retaildata <span class="ot">&lt;-</span> retaildata <span class="sc">%&gt;%</span></span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(CustomerID) <span class="sc">%&gt;%</span>  <span class="co"># Group by CustomerID</span></span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb21-63"><a href="#cb21-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_spent =</span> <span class="fu">sum</span>(Quantity <span class="sc">*</span> UnitPrice, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),  <span class="co"># Total amount spent per customer</span></span>
<span id="cb21-64"><a href="#cb21-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_unique_stockcodes =</span> <span class="fu">n_distinct</span>(StockCode),  <span class="co"># Count of unique products purchased</span></span>
<span id="cb21-65"><a href="#cb21-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_spent_per_product =</span> total_spent <span class="sc">/</span> total_unique_stockcodes  <span class="co"># Average spend per product</span></span>
<span id="cb21-66"><a href="#cb21-66" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb21-67"><a href="#cb21-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()  <span class="co"># Remove grouping to restore normal dataframe structure</span></span>
<span id="cb21-68"><a href="#cb21-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-69"><a href="#cb21-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-70"><a href="#cb21-70" aria-hidden="true" tabindex="-1"></a>retaildata <span class="ot">&lt;-</span> retaildata <span class="sc">%&gt;%</span></span>
<span id="cb21-71"><a href="#cb21-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">avg_days_between_orders =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(avg_days_between_orders), <span class="dv">0</span>, avg_days_between_orders))</span>
<span id="cb21-72"><a href="#cb21-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-73"><a href="#cb21-73" aria-hidden="true" tabindex="-1"></a>retaildata <span class="ot">&lt;-</span> retaildata <span class="sc">%&gt;%</span></span>
<span id="cb21-74"><a href="#cb21-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(CustomerID) <span class="sc">%&gt;%</span>  <span class="co"># Group by CustomerID</span></span>
<span id="cb21-75"><a href="#cb21-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb21-76"><a href="#cb21-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_quantity =</span> <span class="fu">sum</span>(Quantity, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),  <span class="co"># Total quantity purchased per customer</span></span>
<span id="cb21-77"><a href="#cb21-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_orders =</span> <span class="fu">n_distinct</span>(InvoiceNo),  <span class="co"># Count unique orders per customer</span></span>
<span id="cb21-78"><a href="#cb21-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_quantity_per_order =</span> total_quantity <span class="sc">/</span> total_orders  <span class="co"># Compute average quantity per order</span></span>
<span id="cb21-79"><a href="#cb21-79" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb21-80"><a href="#cb21-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()  <span class="co"># Remove grouping to restore normal dataframe structure</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="adding-dummy-variables" class="level3" data-number="2.5.2">
<h3 data-number="2.5.2" class="anchored" data-anchor-id="adding-dummy-variables"><span class="header-section-number">2.5.2</span> Adding dummy variables</h3>
<p>This code snippet uses the <strong>caret</strong> package to create dummy (one-hot encoded) variables for the “Country” column in your dataset. It works as follows:</p>
<p><strong>dummyVars(“~ Country”, data = retaildata):</strong><br>
Creates a dummy variable model for the “Country” column, which specifies how to convert the categorical variable into a set of binary (dummy) columns.</p>
<p><strong>predict(dummy_model, newdata = retaildata):</strong><br>
Applies the dummy variable model to your data to generate the dummy variables. The result is then converted into a data frame.</p>
<p><strong>cbind(retaildata, country_dummies):</strong><br>
Combines the original dataset with the new dummy variables side by side, so you end up with the original columns plus a set of binary columns corresponding to each unique value in “Country”.</p>
<p>In summary, this code transforms the “Country” column into several dummy columns and then appends these columns back to your original dataset, enabling you to use the encoded country data in further analyses.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>dummy_model <span class="ot">&lt;-</span> <span class="fu">dummyVars</span>(<span class="st">"~ Country"</span>, <span class="at">data =</span> retaildata)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>country_dummies <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">predict</span>(dummy_model, <span class="at">newdata =</span> retaildata))</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine dummy columns back into the data set</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>retaildata <span class="ot">&lt;-</span> <span class="fu">cbind</span>(retaildata, country_dummies)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Removing variables and standarizing data set</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>retaildata_scaled <span class="ot">&lt;-</span> retaildata <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1. Remove the specified columns</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>Description, <span class="sc">-</span>Country, <span class="sc">-</span>Quantity, <span class="sc">-</span>UnitPrice, <span class="sc">-</span>InvoiceDate, <span class="sc">-</span>StockCode, <span class="sc">-</span>first_order_date, <span class="sc">-</span>last_order_date, <span class="sc">-</span>InvoiceNo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>retaildata_scaled <span class="ot">&lt;-</span> retaildata_scaled <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.integer, as.numeric)  <span class="co"># Convert all integer columns to numeric</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>retaildata_scaled <span class="ot">&lt;-</span> retaildata_scaled <span class="sc">%&gt;%</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()  <span class="co"># Removes completely identical rows (duplicates across all columns)</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Gem CustomerID i en separat vektor, inden du fjerner den</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>customerIDs <span class="ot">&lt;-</span> retaildata_scaled<span class="sc">$</span>CustomerID</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>retaildata_scaled <span class="ot">&lt;-</span> retaildata_scaled <span class="sc">%&gt;%</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>CustomerID)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify columns that have more than two unique values</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>cols_to_scale <span class="ot">&lt;-</span> retaildata_scaled <span class="sc">%&gt;%</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_if</span>(is.numeric) <span class="sc">%&gt;%</span>  <span class="co"># Select only numeric columns</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(n_distinct) <span class="sc">%&gt;%</span>  <span class="co"># Count distinct values per column</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(variable, unique_values) <span class="sc">%&gt;%</span>  <span class="co"># Convert to long format</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(unique_values <span class="sc">&gt;</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span>  <span class="co"># Keep only columns with more than 2 unique values</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(variable)  <span class="co"># Extract column names</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize only the selected columns</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>retaildata_scaled <span class="ot">&lt;-</span> retaildata_scaled <span class="sc">%&gt;%</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(cols_to_scale), scale)  <span class="co"># Apply scale() only to selected columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Check for NA values before K-means</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(retaildata_scaled)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   21422 obs. of  48 variables:
 $ total_distinct_stockcodes   : num [1:21422, 1] -0.495 -0.495 -0.199 -0.199 -0.167 ...
  ..- attr(*, "scaled:center")= num 161
  ..- attr(*, "scaled:scale")= num 278
 $ total_quantity_purchased    : num [1:21422, 1] -0.2426 -0.2426 -0.2641 -0.2641 -0.0317 ...
  ..- attr(*, "scaled:center")= num 5507
  ..- attr(*, "scaled:scale")= num 15719
 $ customer_active_days        : num [1:21422, 1] -1.415 -1.415 0.771 0.771 1.004 ...
  ..- attr(*, "scaled:center")= num 247
  ..- attr(*, "scaled:scale")= num 124
 $ days_since_last_order       : num [1:21422, 1] -0.593 -0.593 -0.593 -0.593 -0.593 ...
  ..- attr(*, "scaled:center")= num 27.3
  ..- attr(*, "scaled:scale")= num 46
 $ avg_days_between_orders     : num [1:21422, 1] -0.332 -0.332 -0.145 -0.145 -0.178 ...
  ..- attr(*, "scaled:center")= num 2.94
  ..- attr(*, "scaled:scale")= num 8.14
 $ total_orders                : num [1:21422, 1] 0.3759 0.3759 -0.0708 -0.0708 -0.0708 ...
  ..- attr(*, "scaled:center")= num 20.7
  ..- attr(*, "scaled:scale")= num 38.1
 $ total_quantity              : num [1:21422, 1] -0.2426 -0.2426 -0.2641 -0.2641 -0.0317 ...
  ..- attr(*, "scaled:center")= num 5507
  ..- attr(*, "scaled:scale")= num 15719
 $ total_unique_stockcodes     : num [1:21422, 1] -0.495 -0.495 -0.199 -0.199 -0.167 ...
  ..- attr(*, "scaled:center")= num 161
  ..- attr(*, "scaled:scale")= num 278
 $ total_spent                 : num [1:21422, 1] -0.1539 -0.1539 -0.235 -0.235 -0.0843 ...
  ..- attr(*, "scaled:center")= num 9485
  ..- attr(*, "scaled:scale")= num 27261
 $ avg_spent_per_product       : num [1:21422, 1] 0.5928 0.5928 -0.2273 -0.2273 -0.0839 ...
  ..- attr(*, "scaled:center")= num 82.1
  ..- attr(*, "scaled:scale")= num 233
 $ avg_quantity_per_order      : num [1:21422, 1] -0.585 -0.585 -0.492 -0.492 0.214 ...
  ..- attr(*, "scaled:center")= num 217
  ..- attr(*, "scaled:scale")= num 288
 $ Country.Australia           : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Country.Austria             : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Country.Bahrain             : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Country.Belgium             : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Country.Brazil              : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Country.Canada              : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Country.Channel.Islands     : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Country.Cyprus              : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Country.Czech.Republic      : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Country.Denmark             : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Country.EIRE                : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Country.European.Community  : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Country.Finland             : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Country.France              : num  0 0 0 0 1 0 0 0 0 0 ...
 $ Country.Germany             : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Country.Greece              : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Country.Iceland             : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Country.Israel              : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Country.Italy               : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Country.Japan               : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Country.Lebanon             : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Country.Lithuania           : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Country.Malta               : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Country.Netherlands         : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Country.Norway              : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Country.Poland              : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Country.Portugal            : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Country.RSA                 : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Country.Saudi.Arabia        : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Country.Singapore           : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Country.Spain               : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Country.Sweden              : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Country.Switzerland         : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Country.United.Arab.Emirates: num  0 0 0 0 0 0 0 0 0 0 ...
 $ Country.United.Kingdom      : num  1 1 1 1 0 1 1 1 1 1 ...
 $ Country.Unspecified         : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Country.USA                 : num  0 0 0 0 0 0 0 0 0 0 ...</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(retaildata_scaled))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(retaildata_scaled))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                                          
                           0                            0 
                                                          
                           0                            0 
                                                          
                           0                            0 
                                                          
                           0                            0 
                                                          
                           0                            0 
                                        Country.Australia 
                           0                            0 
             Country.Austria              Country.Bahrain 
                           0                            0 
             Country.Belgium               Country.Brazil 
                           0                            0 
              Country.Canada      Country.Channel.Islands 
                           0                            0 
              Country.Cyprus       Country.Czech.Republic 
                           0                            0 
             Country.Denmark                 Country.EIRE 
                           0                            0 
  Country.European.Community              Country.Finland 
                           0                            0 
              Country.France              Country.Germany 
                           0                            0 
              Country.Greece              Country.Iceland 
                           0                            0 
              Country.Israel                Country.Italy 
                           0                            0 
               Country.Japan              Country.Lebanon 
                           0                            0 
           Country.Lithuania                Country.Malta 
                           0                            0 
         Country.Netherlands               Country.Norway 
                           0                            0 
              Country.Poland             Country.Portugal 
                           0                            0 
                 Country.RSA         Country.Saudi.Arabia 
                           0                            0 
           Country.Singapore                Country.Spain 
                           0                            0 
              Country.Sweden          Country.Switzerland 
                           0                            0 
Country.United.Arab.Emirates       Country.United.Kingdom 
                           0                            0 
         Country.Unspecified                  Country.USA 
                           0                            0 </code></pre>
</div>
</div>
</section>
</section>
<section id="modelling" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="modelling"><span class="header-section-number">2.6</span> Modelling</h2>
<p>The <strong>Modeling</strong> phase in CRISP-DM focuses on applying <strong>statistical or machine learning algorithms</strong> to extract patterns and insights from the prepared data. This involves <strong>selecting appropriate models, tuning hyperparameters, training the models, and evaluating their performance</strong> using relevant metrics (e.g., accuracy, RMSE, precision-recall). Different models may be tested and compared to identify the best-performing approach. A well-structured modeling process ensures <strong>robust and reliable predictions</strong> that align with business objectives.</p>
<p>This code first converts all integer columns to numeric and removes any duplicate rows from the dataset. It then saves the “CustomerID” column in a separate vector and removes it temporarily so that it is not affected by the scaling process. Next, the code identifies all numeric columns that have more than two unique values (i.e., actual features) and excludes “CustomerID” from this list. Finally, it applies standardization (scaling) to these selected columns. Optionally, the “CustomerID” column can be re-added to the dataset afterward. Useing the “elbow” method, we defines the optimal cnumber of clusters to 7.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the Elbow Method to choose the optimal number of clusters</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># Ensures reproducible results</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>wss <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">20</span>)  <span class="co"># Vector to store total within-cluster sum of squares (WSS) for k=1..20</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>) {</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(retaildata_scaled, <span class="at">centers =</span> k, <span class="at">nstart =</span> <span class="dv">10</span>, <span class="at">iter.max =</span> <span class="dv">20</span>)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  wss[k] <span class="ot">&lt;-</span> model<span class="sc">$</span>tot.withinss</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Plot the results and look for the “elbow”</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, wss, <span class="at">type =</span> <span class="st">"b"</span>,</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Number of Clusters (k)"</span>,</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Total Within-Cluster Sum of Squares (WSS)"</span>,</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Elbow Method for Retail Data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/K-means%20elbow-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This code performs K-means clustering on the scaled dataset and then visualizes the cluster centroids. First, it sets a reproducible seed and defines the number of clusters (4). The K-means model is then trained using the scaled data, and the resulting cluster centers are extracted and converted into a data frame. Each cluster is labeled with an identifier, and the data is reshaped into long format using the <strong>melt()</strong> function for easy plotting. A bar plot is generated to visualize the centroid values across features for each cluster, helping to compare and understand the differences between clusters. Finally, the cluster assignments are added back to the original scaled dataset, and the code prints out the number of observations in each cluster.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fmsb)  <span class="co"># Load for radar charts</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)  <span class="co"># Load for data manipulation</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)  <span class="co"># Load for data reshaping</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># Ensures reproducibility</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>k_optimal <span class="ot">&lt;-</span> <span class="dv">4</span>  <span class="co"># Set the optimal number of clusters to 4</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the K-means model with the chosen number of clusters</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>kmeans_model <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(retaildata_scaled, <span class="at">centers =</span> k_optimal, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the cluster centers to a dataframe for visualization</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>centers_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(kmeans_model<span class="sc">$</span>centers)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a column to label each cluster</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>centers_df<span class="sc">$</span>Cluster <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(centers_df))</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform to 'long' format for ggplot2 visualization</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>centers_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(centers_df, <span class="at">id.vars =</span> <span class="st">"Cluster"</span>)</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar plot to visualize cluster centroids</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(centers_long, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> value, <span class="at">fill =</span> Cluster)) <span class="sc">+</span> </span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span>  <span class="co"># Bar plot for centroid values</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span>  <span class="co"># Rotate x-axis labels</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Feature"</span>, <span class="at">y =</span> <span class="st">"Centroid Value"</span>, <span class="at">fill =</span> <span class="st">"Cluster"</span>) <span class="sc">+</span>  <span class="co"># Axis labels and legend</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Centroid Values for Each Cluster from K-Means"</span>)  <span class="co"># Plot title</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/clustering-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign cluster labels to the original dataset</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>retaildata_scaled<span class="sc">$</span>clusterKmeans <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(kmeans_model<span class="sc">$</span>cluster)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the number of observations in each cluster</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(retaildata_scaled<span class="sc">$</span>clusterKmeans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    1     2     3     4 
13698   623   877  6224 </code></pre>
</div>
</div>
</section>
<section id="evaluation" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="evaluation"><span class="header-section-number">2.7</span> Evaluation</h2>
<p>The <strong>Evaluation</strong> phase in CRISP-DM ensures that the developed model meets <strong>business objectives and delivers meaningful insights</strong>. This involves assessing <strong>model performance using key metrics</strong> (e.g., accuracy, precision, recall, RMSE), checking for <strong>overfitting or bias</strong>, and validating whether the model’s predictions are actionable. If the results are unsatisfactory, adjustments may be needed in <strong>data preparation or modeling</strong> before deployment. The goal is to ensure the model is <strong>reliable, interpretable, and aligned with business needs</strong> before implementation.</p>
<p>This code block performs several key tasks in evaluating and integrating the clustering results:</p>
<p><strong>Centroid Extraction and Visualization:</strong><br>
The code converts the K-means cluster centroids into a data frame and adds a “Cluster” identifier. It then prints these centroids (with three decimal places) to facilitate inspection of the cluster characteristics.</p>
<p><strong>Radar Chart Generation:</strong><br>
A function, <code>plot_top_features_radar</code>, is defined to extract the top N (in this case, 6) most influential features (based on absolute values) from a given cluster’s centroid. This function normalizes the data by including the overall minimum and maximum values across all clusters, and then it generates a radar chart to visually compare the dominant features of each cluster.</p>
<p><strong>Cluster Summary:</strong><br>
The code computes the average values of all numeric features for each cluster by grouping on <code>clusterKmeans</code> and then prints a summary of these means for all clusters.</p>
<p><strong>Integration of Cluster Assignments:</strong><br>
Finally, it ensures that the CustomerID column is correctly preserved and of the proper type, and then it performs a left join to add the cluster assignment (<code>clusterKmeans</code>) from the scaled dataset back into the original dataset. This allows for the segmentation results to be linked with the original customer data for further analysis.</p>
<p><strong>Cluster 1: Moderate Buyers with Occasional Activity</strong></p>
<ul>
<li><p><strong>Slightly below average in distinct stock codes (-0.107) and total quantity (-0.151).</strong></p></li>
<li><p><strong>Moderate customer activity (0.522), meaning they engage periodically.</strong></p></li>
<li><p><strong>Total spent (-0.147) and avg spent per product (-0.0648) are slightly below average.</strong></p></li>
<li><p><strong>Days since last order (0.198) and avg days between orders (0.0715) indicate occasional purchasing.</strong></p></li>
<li><p><strong>Likely a mix of Average Customers and Occasional Buyers.</strong></p></li>
</ul>
<p>💡 <strong>Possible Label:</strong> <strong>“Average Customers” or “Occasional Buyers”</strong><br>
📢 <strong>Strategy:</strong> Offer promotions to encourage frequent purchases.</p>
<p><strong>Cluster 2: High-Value and Bulk Buyers</strong></p>
<ul>
<li><p><strong>Significantly higher spending (3.618) and total quantity purchased (3.597).</strong></p></li>
<li><p><strong>Much higher number of distinct stock codes (0.515) and total orders (0.772).</strong></p></li>
<li><p><strong>High avg spent per product (3.6784) → they spend a lot on each item.</strong></p></li>
<li><p><strong>Lower avg days between orders (-0.0276), meaning they buy regularly.</strong></p></li>
<li><p><strong>They are highly engaged (customer active days: 0.804).</strong></p></li>
</ul>
<p>💡 <strong>Possible Label:</strong> <strong>“High-Value Buyers” or “Bulk Buyers”</strong><br>
📢 <strong>Strategy:</strong> Offer VIP programs, bulk discounts, and loyalty perks.</p>
<p><strong>Cluster 3: Very High Engagement but Smaller Purchases</strong></p>
<ul>
<li><p><strong>Extremely high distinct stock codes (4.071), total quantity (1.993), and customer active days (0.965).</strong></p></li>
<li><p><strong>Frequent buyers but smaller average spent per product (-0.1280).</strong></p></li>
<li><p><strong>Lower avg days between orders (-0.3484), meaning very frequent purchases.</strong></p></li>
<li><p><strong>High total orders (4.172), meaning they buy often but in lower quantities.</strong></p></li>
<li><p><strong>Likely represents small business resellers or highly engaged individual buyers.</strong></p></li>
</ul>
<p>💡 <strong>Possible Label:</strong> <strong>“Frequent Buyers” or “Small Business Customers”</strong><br>
📢 <strong>Strategy:</strong> Introduce <strong>subscription models</strong>, loyalty programs, or automatic reorders.</p>
<p><strong>Cluster 4: Churn Risk / Inactive Customers</strong></p>
<ul>
<li><p><strong>All values are negative, indicating below-average purchasing behavior.</strong></p></li>
<li><p><strong>Very low total distinct stock codes (-0.390) and total quantity (-0.308).</strong></p></li>
<li><p><strong>Low customer active days (-1.364) suggests they may not have returned in a long time.</strong></p></li>
<li><p><strong>Higher days since last order (-0.325) means they haven’t purchased recently.</strong></p></li>
<li><p><strong>Total spent (-0.308) and avg spent per product (-0.2075) are very low.</strong></p></li>
<li><p><strong>Represents customers who are at risk of churning or have already churned.</strong></p></li>
</ul>
<p>💡 <strong>Possible Label:</strong> <strong>“Churn Risk Customers” or “Inactive Customers”</strong><br>
📢 <strong>Strategy:</strong> <strong>Re-engagement campaigns, special discounts, or personalized emails</strong> to bring them back.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert K-Means centroids to a readable dataframe</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>centroid_values <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(kmeans_model<span class="sc">$</span>centers)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a cluster identifier column</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>centroid_values<span class="sc">$</span>Cluster <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(centroid_values)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the table with all cluster centroid values</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(centroid_values, <span class="at">digits =</span> <span class="dv">3</span>)  <span class="co"># Show 3 decimal places for readability</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  total_distinct_stockcodes total_quantity_purchased customer_active_days
1                    -0.107                   -0.151                0.522
2                     0.515                    3.597                0.804
3                     4.071                    1.993                0.965
4                    -0.390                   -0.308               -1.364
  days_since_last_order avg_days_between_orders total_orders total_quantity
1                 0.198                  0.0715       -0.103         -0.151
2                -0.360                 -0.0276        0.772          3.597
3                -0.536                 -0.3484        4.172          1.993
4                -0.325                 -0.1054       -0.439         -0.308
  total_unique_stockcodes total_spent avg_spent_per_product
1                  -0.107      -0.147               -0.0648
2                   0.515       3.618                3.6784
3                   4.071       1.909               -0.1280
4                  -0.390      -0.308               -0.2075
  avg_quantity_per_order Country.Australia Country.Austria Country.Bahrain
1                -0.1032          0.002701        0.000584        0.000000
2                 3.8609          0.038523        0.000000        0.000000
3                -0.0404          0.000000        0.000000        0.000000
4                -0.1537          0.000482        0.002089        0.000321
  Country.Belgium Country.Brazil Country.Canada Country.Channel.Islands
1         0.00562       0.000000       0.000000                 0.00153
2         0.00000       0.000000       0.000000                 0.00000
3         0.00000       0.000000       0.000000                 0.00000
4         0.00691       0.000161       0.000964                 0.00177
  Country.Cyprus Country.Czech.Republic Country.Denmark Country.EIRE
1       0.000803               0.000365        0.000657     0.000292
2       0.000000               0.000000        0.000000     0.099518
3       0.000000               0.000000        0.000000     0.246294
4       0.001446               0.000000        0.002089     0.000161
  Country.European.Community Country.Finland Country.France Country.Germany
1                   0.000000         0.00190         0.0241          0.0321
2                   0.000000         0.00000         0.0000          0.0000
3                   0.000000         0.00000         0.0000          0.0000
4                   0.000803         0.00353         0.0202          0.0239
  Country.Greece Country.Iceland Country.Israel Country.Italy Country.Japan
1       0.000000        0.000511       0.000073       0.00270      0.000949
2       0.000000        0.000000       0.000000       0.00000      0.004815
3       0.000000        0.000000       0.000000       0.00000      0.000000
4       0.000964        0.000000       0.000803       0.00273      0.002089
  Country.Lebanon Country.Lithuania Country.Malta Country.Netherlands
1        0.000000          0.000000      0.000073            0.001314
2        0.000000          0.000000      0.000000            0.097913
3        0.000000          0.000000      0.000000            0.000000
4        0.000161          0.000482      0.001446            0.000964
  Country.Norway Country.Poland Country.Portugal Country.RSA
1        0.00146       0.001314          0.00277    0.000000
2        0.00000       0.000000          0.00000    0.000000
3        0.00000       0.000000          0.00000    0.000000
4        0.00321       0.000964          0.00450    0.000161
  Country.Saudi.Arabia Country.Singapore Country.Spain Country.Sweden
1             0.000000          0.000657       0.00569        0.00139
2             0.000000          0.000000       0.00000        0.02568
3             0.000000          0.000000       0.00000        0.00000
4             0.000321          0.000000       0.00466        0.00145
  Country.Switzerland Country.United.Arab.Emirates Country.United.Kingdom
1             0.00161                     0.000000                  0.909
2             0.00000                     0.000000                  0.734
3             0.00000                     0.000000                  0.754
4             0.00787                     0.000482                  0.900
  Country.Unspecified Country.USA Cluster
1            0.000073     0.00000       1
2            0.000000     0.00000       2
3            0.000000     0.00000       3
4            0.001125     0.00112       4</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fmsb)  <span class="co"># Load for radar charts</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)  <span class="co"># Load for data manipulation</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)  <span class="co"># Load for data reshaping</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to plot only the most defining features for a cluster</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>plot_top_features_radar <span class="ot">&lt;-</span> <span class="cf">function</span>(cluster_num, <span class="at">top_n =</span> <span class="dv">5</span>) {</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the centroid values for the selected cluster</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  cluster_data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(kmeans_model<span class="sc">$</span>centers)[cluster_num, , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find the top N most influential features (highest absolute values)</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  top_features <span class="ot">&lt;-</span> cluster_data <span class="sc">%&gt;%</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"Feature"</span>, <span class="at">value =</span> <span class="st">"CentroidValue"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="fu">abs</span>(CentroidValue))) <span class="sc">%&gt;%</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span>top_n) <span class="sc">%&gt;%</span>  <span class="co"># Select only the top N features</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Feature)  <span class="co"># Extract feature names</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset the centroid data to keep only the selected features</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>  cluster_data <span class="ot">&lt;-</span> cluster_data[, top_features, drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find min/max values for the selected features for scaling</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>  max_vals <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">as.data.frame</span>(kmeans_model<span class="sc">$</span>centers)[, top_features, <span class="at">drop =</span> <span class="cn">FALSE</span>], <span class="dv">2</span>, max)</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>  min_vals <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">as.data.frame</span>(kmeans_model<span class="sc">$</span>centers)[, top_features, <span class="at">drop =</span> <span class="cn">FALSE</span>], <span class="dv">2</span>, min)</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add min/max rows for normalization</span></span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>  cluster_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(max_vals, min_vals, cluster_data)</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define colors for visualization</span></span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>  cluster_color <span class="ot">&lt;-</span> <span class="st">"blue"</span></span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>  fill_color <span class="ot">&lt;-</span> <span class="fu">adjustcolor</span>(cluster_color, <span class="at">alpha.f =</span> <span class="fl">0.3</span>)  <span class="co"># Lightened color</span></span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate the radar chart</span></span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">radarchart</span>(cluster_data,</span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>             <span class="at">axistype =</span> <span class="dv">2</span>,  <span class="co"># Show axis labels</span></span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">pcol =</span> cluster_color,  <span class="co"># Border color for the cluster</span></span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>             <span class="at">pfcol =</span> fill_color,  <span class="co"># Fill color</span></span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>             <span class="at">plwd =</span> <span class="dv">2</span>,  <span class="co"># Line width</span></span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a>             <span class="at">cglcol =</span> <span class="st">"gray"</span>, <span class="at">cglty =</span> <span class="dv">1</span>, <span class="at">cglwd =</span> <span class="fl">0.8</span>,  <span class="co"># Grid settings</span></span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a>             <span class="at">axislabcol =</span> <span class="st">"black"</span>,  <span class="co"># Axis label color</span></span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a>             <span class="at">vlcex =</span> <span class="fl">0.8</span>)  <span class="co"># Size of variable labels</span></span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-42"><a href="#cb37-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add a title</span></span>
<span id="cb37-43"><a href="#cb37-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">title</span>(<span class="fu">paste</span>(<span class="st">"Top"</span>, top_n, <span class="st">"Features for Cluster"</span>, cluster_num), <span class="at">cex.main =</span> <span class="fl">1.5</span>)</span>
<span id="cb37-44"><a href="#cb37-44" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-45"><a href="#cb37-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-46"><a href="#cb37-46" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_top_features_radar</span>(<span class="dv">1</span>, <span class="at">top_n =</span> <span class="dv">6</span>)  <span class="co"># View Cluster 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/Evaluation-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_top_features_radar</span>(<span class="dv">2</span>, <span class="at">top_n =</span> <span class="dv">6</span>)  <span class="co"># View Cluster 2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/Evaluation-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_top_features_radar</span>(<span class="dv">3</span>, <span class="at">top_n =</span> <span class="dv">6</span>)  <span class="co"># View Cluster 3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/Evaluation-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_top_features_radar</span>(<span class="dv">4</span>, <span class="at">top_n =</span> <span class="dv">6</span>)  <span class="co"># View Cluster 4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/Evaluation-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>cluster_summary <span class="ot">&lt;-</span> retaildata_scaled <span class="sc">%&gt;%</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(clusterKmeans) <span class="sc">%&gt;%</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="cn">Inf</span>)  <span class="co"># Show all cluster mean values</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 49
  clusterKmeans total_distinct_stockcodes total_quantity_purchased
  &lt;fct&gt;                             &lt;dbl&gt;                    &lt;dbl&gt;
1 1                                -0.107                   -0.151
2 2                                 0.515                    3.60 
3 3                                 4.07                     1.99 
4 4                                -0.390                   -0.308
# ℹ 46 more variables: customer_active_days &lt;dbl&gt;, days_since_last_order &lt;dbl&gt;,
#   avg_days_between_orders &lt;dbl&gt;, total_orders &lt;dbl&gt;, total_quantity &lt;dbl&gt;,
#   total_unique_stockcodes &lt;dbl&gt;, total_spent &lt;dbl&gt;,
#   avg_spent_per_product &lt;dbl&gt;, avg_quantity_per_order &lt;dbl&gt;,
#   Country.Australia &lt;dbl&gt;, Country.Austria &lt;dbl&gt;, Country.Bahrain &lt;dbl&gt;,
#   Country.Belgium &lt;dbl&gt;, Country.Brazil &lt;dbl&gt;, Country.Canada &lt;dbl&gt;,
#   Country.Channel.Islands &lt;dbl&gt;, Country.Cyprus &lt;dbl&gt;, …</code></pre>
</div>
</div>
<p><img src="images/clipboard-1105416059.png" class="img-fluid"></p>
</section>
<section id="deployment" class="level2" data-number="2.8">
<h2 data-number="2.8" class="anchored" data-anchor-id="deployment"><span class="header-section-number">2.8</span> Deployment</h2>
<p>The <strong>Deployment</strong> phase in CRISP-DM focuses on integrating the final model into a <strong>real-world application or business process</strong>. This can involve <strong>automating predictions, embedding the model into a system, or generating reports for decision-making</strong>. Monitoring and maintenance are crucial to ensure the model remains accurate and adapts to new data over time. The ultimate goal is to <strong>turn insights into actionable strategies</strong> that drive business value.</p>
<p>This code is part of the deployment stage. It converts the cluster labels (stored in the “clusterKmeans” column) into descriptive customer segments for both the scaled dataset (<code>retaildata_scaled</code>) and the joined dataset (<code>retaildata_with_segments</code>). It then creates a table of the number of customers in each segment, which is visualized using a bar plot. Finally, it generates two box plots: one showing the distribution of “total_quantity_purchased” and the other displaying “customer_active_days” for each customer segment. These visualizations provide an overview of both the size and key behavioral characteristics of each customer group.</p>
<p>Feel free to ask if you need further modifications or explanations!</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>retaildata_scaled<span class="sc">$</span>customer_segment <span class="ot">&lt;-</span> <span class="fu">factor</span>(retaildata_scaled<span class="sc">$</span>clusterKmeans,</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Occasional Buyers"</span>, </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>                                                        <span class="st">"High Value / Bulk Buyers"</span>,</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>                                                        <span class="st">"Frequest Buyers"</span>,</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>                                                        <span class="st">"Churn Risk Customers"</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>                                                        ))</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>retaildata_with_segments<span class="sc">$</span>customer_segment <span class="ot">&lt;-</span> <span class="fu">factor</span>(retaildata_with_segments<span class="sc">$</span>clusterKmeans,</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Occasional Buyers"</span>, </span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>                                                        <span class="st">"High Value / Bulk Buyers"</span>,</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>                                                        <span class="st">"Frequest Buyers"</span>,</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>                                                        <span class="st">"Churn Risk Customers"</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>                                                        ))</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>cluster_sizes <span class="ot">&lt;-</span> <span class="fu">table</span>(retaildata_scaled<span class="sc">$</span>customer_segment)</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(cluster_sizes, <span class="at">main =</span> <span class="st">"Number of Customers in Each Segment"</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/Deloyment-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(retaildata_scaled, <span class="fu">aes</span>(<span class="at">x =</span> customer_segment, <span class="at">y =</span> total_quantity_purchased, <span class="at">fill =</span> customer_segment)) <span class="sc">+</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Quantity Purchased by Customer Segment"</span>,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Customer Segment"</span>, </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Total Quantity Purchased"</span>) <span class="sc">+</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/Deloyment-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(retaildata_scaled, <span class="fu">aes</span>(<span class="at">x =</span> customer_segment, <span class="at">y =</span> customer_active_days, <span class="at">fill =</span> customer_segment)) <span class="sc">+</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Active Days by Customer Segment"</span>,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Customer Segment"</span>, </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Customer Active Days"</span>) <span class="sc">+</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/Deloyment-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="segment-insights-actionable-strategies" class="level3" data-number="2.8.1">
<h3 data-number="2.8.1" class="anchored" data-anchor-id="segment-insights-actionable-strategies"><span class="header-section-number">2.8.1</span> <strong>Segment Insights &amp; Actionable Strategies</strong></h3>
<p>1️⃣ <strong>Occasional Buyers</strong></p>
<ul>
<li><p><strong>Key Insights</strong>: Buy infrequently but remain engaged.</p></li>
<li><p><strong>Actionable Strategies</strong>: Send <strong>personalized recommendations</strong> and offer <strong>loyalty rewards</strong> to encourage more frequent purchases.</p></li>
</ul>
<p>2️⃣ <strong>High-Value / Bulk Buyers</strong></p>
<ul>
<li><p><strong>Key Insights</strong>: Spend a lot and purchase frequently OR buy large quantities less often.</p></li>
<li><p><strong>Actionable Strategies</strong>: Offer <strong>exclusive VIP perks, early access to deals, and bulk discounts</strong> to maximize their spending potential.</p></li>
</ul>
<p>3️⃣ <strong>Frequent Buyers</strong></p>
<ul>
<li><p><strong>Key Insights</strong>: Purchase <strong>often but in smaller amounts</strong>.</p></li>
<li><p><strong>Actionable Strategies</strong>: Introduce <strong>subscription models</strong> and <strong>frequent buyer programs</strong> to encourage continued engagement.</p></li>
</ul>
<p>4️⃣ <strong>Churn Risk / Inactive Customers</strong></p>
<ul>
<li><p><strong>Key Insights</strong>: <strong>Very low quantity &amp; low active days</strong>, or haven’t bought in a long time.</p></li>
<li><p><strong>Actionable Strategies</strong>: Run <strong>win-back campaigns</strong>, send <strong>re-engagement emails</strong>, and provide <strong>exclusive discounts</strong> to bring them back.</p></li>
</ul>
</section>
<section id="how-to-use-these-insights" class="level3" data-number="2.8.2">
<h3 data-number="2.8.2" class="anchored" data-anchor-id="how-to-use-these-insights"><span class="header-section-number">2.8.2</span> <strong>How to Use These Insights</strong></h3>
<p>🔹 <strong>For Marketing Teams:</strong></p>
<ul>
<li><p><strong>VIP Customers</strong> → Offer <strong>exclusive perks, loyalty programs, and early access to sales</strong>.</p></li>
<li><p><strong>Bulk Buyers</strong> → Provide <strong>wholesale pricing and custom deals</strong> to maintain their high-value transactions.</p></li>
<li><p><strong>Frequent Buyers</strong> → Implement <strong>subscription services and membership discounts</strong> to ensure customer retention.</p></li>
<li><p><strong>Churn Risk Customers</strong> → Deploy <strong>re-engagement campaigns, special discounts, and personalized offers</strong> to regain their interest.</p></li>
</ul>
<p>🔹 <strong>For Product Teams:</strong></p>
<ul>
<li><p>Identify which products attract specific segments.</p></li>
<li><p>Optimize pricing strategies based on spending patterns.</p></li>
<li><p>Improve <strong>customer retention strategies</strong> by aligning marketing with behavioral insights.</p></li>
</ul>
</section>
</section>
</section>
<section id="recommendations" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Recommendations</h1>
<section id="potential-improvements-to-the-model" class="level3" data-number="3.0.1">
<h3 data-number="3.0.1" class="anchored" data-anchor-id="potential-improvements-to-the-model"><span class="header-section-number">3.0.1</span> <strong>Potential Improvements to the Model</strong></h3>
<p>To enhance the accuracy and effectiveness of the customer segmentation model, several refinements can be considered:</p>
<p>1️⃣ <strong>Incorporating Additional Influential Variables</strong></p>
<ul>
<li><p>The current model may <strong>not fully capture all relevant factors</strong> affecting customer behavior. Additional features, such as <strong>purchase recency, seasonal trends, or product categories</strong>, could provide deeper insights into customer preferences.</p></li>
<li><p>Including <strong>customer lifetime value (CLV)</strong> and <strong>frequency of high-value purchases</strong> might help distinguish between casual shoppers and truly valuable customers.</p></li>
</ul>
<p>2️⃣ <strong>Reevaluating the Impact of Country as a Variable</strong></p>
<ul>
<li><p>Preliminary analysis suggests that <strong>geographic location (Country) does not significantly differentiate customer segments</strong>. If further validation confirms this, it may be beneficial to <strong>remove this variable</strong> to reduce noise in the model.</p></li>
<li><p>Instead, <strong>regional spending behavior</strong> or <strong>shipping frequency</strong> might be more relevant features to explore.</p></li>
</ul>
<p>3️⃣ <strong>Fine-Tuning the Clustering Approach</strong></p>
<ul>
<li><p><strong>Revisiting the number of clusters</strong>: The <strong>current segmentation may be too granular</strong>, leading to <strong>small, less meaningful groups</strong>. Reducing the number of clusters could improve interpretability.</p></li>
<li><p><strong>Alternative Clustering Methods</strong>: Exploring <strong>Hierarchical Clustering or DBSCAN</strong> might reveal different grouping patterns that K-Means does not capture effectively.</p></li>
</ul>
<p>4️⃣ <strong>Feature Engineering &amp; Normalization</strong></p>
<ul>
<li><p>Creating <strong>aggregated time-based metrics</strong> (e.g., <strong>purchase trends over different periods</strong>) could improve predictive power.</p></li>
<li><p>Ensuring that <strong>features are appropriately scaled</strong> while preserving meaningful variations can enhance model performance.</p></li>
</ul>
<p>By iterating on these improvements, the customer segmentation model can become <strong>more robust, actionable, and aligned with real-world business applications</strong></p>
</section>
<section id="applying-apriori-can-add-value-to-customer-segmentation" class="level3" data-number="3.0.2">
<h3 data-number="3.0.2" class="anchored" data-anchor-id="applying-apriori-can-add-value-to-customer-segmentation"><span class="header-section-number">3.0.2</span> <strong>Applying Apriori Can Add Value to Customer Segmentation</strong></h3>
<p>By applying <strong>Apriori to transaction data</strong>, you can extract <strong>meaningful rules</strong> that help businesses understand <strong>which products are frequently purchased together</strong> or <strong>how different customer segments behave</strong>. Below are some key applications:</p>
<p>1️⃣ <strong>Understanding Customer Purchase Behavior</strong></p>
<ul>
<li><p>For each <strong>customer segment</strong>, identify <strong>which products are frequently purchased together</strong>.</p></li>
<li><p>Example: If <strong>“High-Value Buyers”</strong> tend to purchase <strong>luxury home decor and seasonal gifts together</strong>, you can use this insight for <strong>bundling strategies</strong>.</p></li>
</ul>
<p>2️⃣ <strong>Enhancing Cross-Selling &amp; Up-Selling Strategies</strong></p>
<ul>
<li><p>If <strong>“Frequent Buyers”</strong> often buy <strong>discounted bulk items</strong>, the business can <strong>offer relevant promotions</strong> to increase basket size.</p></li>
<li><p>If customers in <strong>“Inactive Customers”</strong> segment previously purchased a product that often leads to repeat purchases, targeted <strong>reminders or subscription models</strong> can be introduced.</p></li>
</ul>
<p>3️⃣ <strong>Personalized Marketing Based on Associations</strong></p>
<ul>
<li>If <strong>“Churn Risk Customers”</strong> previously bought <strong>electronic gadgets</strong> but haven’t repurchased, the business can <strong>send targeted discounts</strong> on accessories or complementary products to re-engage them.</li>
</ul>
</section>
</section>
<section id="conclusion" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> <strong>Conclusion</strong></h1>
<p>This project successfully applied <strong>K-Means clustering</strong> to segment customers based on their purchasing behavior, following the <strong>CRISP-DM framework</strong>. By leveraging <strong>transactional data</strong>, we identified four distinct customer groups, each representing unique purchasing patterns and engagement levels.</p>
<p><strong>Key Findings:</strong></p>
<ol type="1">
<li><p><strong>Occasional Buyers:</strong> Customers who buy infrequently but remain engaged. These customers benefit from <strong>personalized recommendations and loyalty rewards</strong> to encourage more frequent purchases.</p></li>
<li><p><strong>High-Value / Bulk Buyers:</strong> Customers who spend a lot and purchase frequently or buy in large quantities less often. <strong>VIP programs, bulk discounts, and early access to deals</strong> can maximize their value.</p></li>
<li><p><strong>Frequent Buyers:</strong> Customers who make <strong>frequent purchases in smaller quantities</strong>. Subscription models and membership discounts can help <strong>increase retention</strong>.</p></li>
<li><p><strong>Churn Risk / Inactive Customers:</strong> Customers with <strong>low purchasing activity</strong> or those who haven’t bought in a long time. <strong>Win-back campaigns and re-engagement strategies</strong> are essential to bringing them back.</p></li>
</ol>
<section id="business-implications" class="level3" data-number="4.0.1">
<h3 data-number="4.0.1" class="anchored" data-anchor-id="business-implications"><span class="header-section-number">4.0.1</span> <strong>Business Implications</strong></h3>
<p>The segmentation results provide valuable <strong>business insights</strong> that can be directly applied to improve <strong>marketing strategies, pricing decisions, and customer retention efforts</strong>:</p>
<ul>
<li><p><strong>Marketing Teams:</strong> Can develop <strong>targeted campaigns</strong> tailored to each segment’s behavior, improving engagement and conversions.</p></li>
<li><p><strong>Sales &amp; Product Teams:</strong> Can use insights to <strong>optimize pricing strategies, create customized offers, and enhance customer experiences</strong>.</p></li>
<li><p><strong>Customer Retention Strategies:</strong> Understanding <strong>which customers are likely to churn</strong> allows businesses to implement <strong>proactive measures</strong> to retain them.</p></li>
</ul>
</section>
<section id="future-improvements" class="level3" data-number="4.0.2">
<h3 data-number="4.0.2" class="anchored" data-anchor-id="future-improvements"><span class="header-section-number">4.0.2</span> <strong>Future Improvements</strong></h3>
<p>To enhance the model’s effectiveness, we propose:</p>
<ul>
<li><p><strong>Incorporating additional behavioral variables</strong> that may impact purchasing habits.</p></li>
<li><p><strong>Reevaluating the importance of geographic location (Country),</strong> as it showed limited influence in this segmentation.</p></li>
<li><p><strong>Exploring association rule mining (Apriori algorithm)</strong> to discover frequent purchase patterns within each segment, enabling <strong>cross-selling and personalized recommendations</strong>.</p></li>
</ul>
<p>By integrating <strong>data-driven customer segmentation</strong>, businesses can transition from <strong>one-size-fits-all marketing</strong> to <strong>highly targeted, personalized strategies</strong>, ultimately leading to improved customer engagement, increased sales, and long-term growth.Literature</p>
</section>
</section>
<section id="litterature" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Litterature</h1>
<p><em>Introducing ChatGPT</em>. (u.å.). Hentet 4. januar 2024, fra https://openai.com/blog/chatgpt</p>
<p><em>Online Retail Data Set</em>. (u.å.). Hentet 13. marts 2025, fra https://www.kaggle.com/datasets/vijayuv/onlineretail</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>